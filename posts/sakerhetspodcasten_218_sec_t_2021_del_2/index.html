<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Säkerhetspodcasten #218 - Sec-T 2021 Del 2 - Säkerhetspodcasten</title><meta name="Description" content="Säkerhetspodcasten - Sveriges första? podcast om IT-säkerhet"><meta property="og:title" content="Säkerhetspodcasten #218 - Sec-T 2021 Del 2" />
<meta property="og:description" content="Lyssna mp3, längd: 39:35 Innehåll Detta är del två av ett antal intervjuavsnitt genomförda under säkerhetskonferensen Sec-T i Stockholm 2021.
AI transkribering AI försöker förstå oss&hellip; Ha överseende med galna feltranskriberingar.
1 00:00:00,000 --&gt; 00:00:05,920 Yes, welcome to this small pre-lightning talk with Erik Hjelmvik
2 00:00:05,920 --&gt; 00:00:09,680 that soon will be entering the stage here at SECTI 2021
3 00:00:09,680 --&gt; 00:00:14,340 here at the SECTI podcast and transmission." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://sakerhetspodcasten.se/posts/sakerhetspodcasten_218_sec_t_2021_del_2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-31T17:35:01+00:00" />
<meta property="article:modified_time" content="2022-01-31T17:35:01+00:00" /><meta property="og:site_name" content="Säkerhetspodcasten" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Säkerhetspodcasten #218 - Sec-T 2021 Del 2"/>
<meta name="twitter:description" content="Lyssna mp3, längd: 39:35 Innehåll Detta är del två av ett antal intervjuavsnitt genomförda under säkerhetskonferensen Sec-T i Stockholm 2021.
AI transkribering AI försöker förstå oss&hellip; Ha överseende med galna feltranskriberingar.
1 00:00:00,000 --&gt; 00:00:05,920 Yes, welcome to this small pre-lightning talk with Erik Hjelmvik
2 00:00:05,920 --&gt; 00:00:09,680 that soon will be entering the stage here at SECTI 2021
3 00:00:09,680 --&gt; 00:00:14,340 here at the SECTI podcast and transmission."/>
<meta name="application-name" content="Säkerhetspodcasten">
<meta name="apple-mobile-web-app-title" content="Säkerhetspodcasten"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://sakerhetspodcasten.se/posts/sakerhetspodcasten_218_sec_t_2021_del_2/" /><link rel="prev" href="https://sakerhetspodcasten.se/posts/s_xe4_kerhetspodcasten_217_ostrukturerat_v_3/" /><link rel="next" href="https://sakerhetspodcasten.se/posts/s_xe4_kerhetspodcasten_218_sec_t_2021_del_2/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Säkerhetspodcasten #218 - Sec-T 2021 Del 2",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/sakerhetspodcasten.se\/posts\/sakerhetspodcasten_218_sec_t_2021_del_2\/"
        },"genre": "posts","keywords": "SEC-T","wordcount":  8668 ,
        "url": "https:\/\/sakerhetspodcasten.se\/posts\/sakerhetspodcasten_218_sec_t_2021_del_2\/","datePublished": "2022-01-31T17:35:01+00:00","dateModified": "2022-01-31T17:35:01+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Author"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Säkerhetspodcasten">Säkerhetspodcasten</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Pods </a><a class="menu-item" href="/pages/lyssna" title="Lyssna"> Lyssna! </a><a class="menu-item" href="/pages/kontakt" title="kontakt"> Kontakt </a><a class="menu-item" href="/pages/panelen" title="panelen"> Panelen </a><a class="menu-item" href="/pages/supportersida-2" title="supporters"> Supporters </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Säkerhetspodcasten">Säkerhetspodcasten</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="/posts/" title="">Pods</a><a class="menu-item" href="/pages/lyssna" title="Lyssna">Lyssna!</a><a class="menu-item" href="/pages/kontakt" title="kontakt">Kontakt</a><a class="menu-item" href="/pages/panelen" title="panelen">Panelen</a><a class="menu-item" href="/pages/supportersida-2" title="supporters">Supporters</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Säkerhetspodcasten #218 - Sec-T 2021 Del 2</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>Author</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-01-31">2022-01-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;8668 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;41 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#lyssna">Lyssna</a></li>
    <li><a href="#innehåll">Innehåll</a></li>
    <li><a href="#ai-transkribering">AI transkribering</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="lyssna">Lyssna</h2>
<ul>
<li><a href="https://traffic.libsyn.com/secure/sakerhetspodcasten/sec-t_2021_part2.mp3?dest-id=117848" target="_blank" rel="noopener noreffer ">mp3</a>, längd: 39:35</li>
</ul>
<h2 id="innehåll">Innehåll</h2>
<p>Detta är del två av ett antal intervjuavsnitt genomförda under säkerhetskonferensen
Sec-T i Stockholm 2021.</p>
<h2 id="ai-transkribering">AI transkribering</h2>
<p><em>AI försöker förstå oss&hellip; Ha överseende med galna feltranskriberingar.</em></p>
<p><code>1 00:00:00,000 --&gt; 00:00:05,920</code>
Yes, welcome to this small pre-lightning talk with Erik Hjelmvik</p>
<p><code>2 00:00:05,920 --&gt; 00:00:09,680</code>
that soon will be entering the stage here at SECTI 2021</p>
<p><code>3 00:00:09,680 --&gt; 00:00:14,340</code>
here at the SECTI podcast and transmission.</p>
<p><code>4 00:00:14,720 --&gt; 00:00:14,980</code>
Precis.</p>
<p><code>5 00:00:15,480 --&gt; 00:00:15,880</code>
Precis.</p>
<p><code>6 00:00:16,080 --&gt; 00:00:16,940</code>
Precis, precis.</p>
<p><code>7 00:00:17,280 --&gt; 00:00:18,700</code>
Cool. Thank you very much.</p>
<p><code>8 00:00:19,540 --&gt; 00:00:20,140</code>
That&rsquo;s perfect.</p>
<p><code>9 00:00:20,760 --&gt; 00:00:24,420</code>
So we just heard that you will be up talking about something</p>
<p><code>10 00:00:24,420 --&gt; 00:00:27,300</code>
that you spent the winter around.</p>
<p><code>11 00:00:27,300 --&gt; 00:00:32,420</code>
Oh yes, I spent way too much time revisioning the backdoor</p>
<p><code>12 00:00:32,420 --&gt; 00:00:34,540</code>
in the SolarWinds Orion product.</p>
<p><code>13 00:00:36,640 --&gt; 00:00:42,460</code>
I did it just to build a decoder for the DNS traffic</p>
<p><code>14 00:00:42,460 --&gt; 00:00:45,680</code>
but the talk is actually not about my decoder</p>
<p><code>15 00:00:45,680 --&gt; 00:00:48,680</code>
it&rsquo;s about a few other things I discovered in the code.</p>
<p><code>16 00:00:48,940 --&gt; 00:00:50,120</code>
Oh, that&rsquo;s cool.</p>
<p><code>17 00:00:50,360 --&gt; 00:00:56,000</code>
So really trying to trick us into watching your talk I guess.</p>
<p><code>18 00:00:56,000 --&gt; 00:00:57,000</code>
I think so.</p>
<p><code>19 00:00:57,300 --&gt; 00:00:58,480</code>
I think I will be watching it anyway.</p>
<p><code>20 00:00:58,840 --&gt; 00:00:58,920</code>
Anyway.</p>
<p><code>21 00:00:59,360 --&gt; 00:01:01,680</code>
It&rsquo;s always interesting to hear what you have to say.</p>
<p><code>22 00:01:02,600 --&gt; 00:01:09,480</code>
But tell us about the messages that were sent out using DNS queries.</p>
<p><code>23 00:01:12,680 --&gt; 00:01:17,780</code>
Basically, what information could you extract from that</p>
<p><code>24 00:01:17,780 --&gt; 00:01:19,600</code>
once you knew how to decode it?</p>
<p><code>25 00:01:20,080 --&gt; 00:01:22,640</code>
There were actually only two pieces of information</p>
<p><code>26 00:01:22,640 --&gt; 00:01:26,540</code>
that was sent from these victims or from the initial victims</p>
<p><code>27 00:01:26,540 --&gt; 00:01:27,280</code>
who were running the project.</p>
<p><code>28 00:01:27,300 --&gt; 00:01:37,540</code>
So the first thing that they said was their internal Active Directory domain name.</p>
<p><code>29 00:01:37,540 --&gt; 00:01:39,300</code>
So they would leak the domain name.</p>
<p><code>30 00:01:40,800 --&gt; 00:01:45,840</code>
Sometimes it was too long so you had to actually split it into two or three DNS packets.</p>
<p><code>31 00:01:46,480 --&gt; 00:01:51,660</code>
After that it would send the installed antivirus or EDR products.</p>
<p><code>32 00:01:52,780 --&gt; 00:01:56,040</code>
Actually, they only had a list of a few products.</p>
<p><code>33 00:01:56,040 --&gt; 00:01:56,960</code>
And if your product&hellip;</p>
<p><code>34 00:01:56,960 --&gt; 00:01:59,960</code>
If your product was on the list, it would sort of send that.</p>
<p><code>35 00:02:01,180 --&gt; 00:02:03,180</code>
And that&rsquo;s all the information the attackers got.</p>
<p><code>36 00:02:03,660 --&gt; 00:02:07,140</code>
So out of that, knowing the Active Directory domain and installed products,</p>
<p><code>37 00:02:07,540 --&gt; 00:02:14,340</code>
they sort of handpicked 1% of those to do further attacks.</p>
<p><code>38 00:02:14,340 --&gt; 00:02:15,080</code>
Exploitation, yeah.</p>
<p><code>39 00:02:15,080 --&gt; 00:02:15,540</code>
Yeah.</p>
<p><code>40 00:02:15,540 --&gt; 00:02:17,540</code>
The other ones, they just disabled the backdoor.</p>
<p><code>41 00:02:17,960 --&gt; 00:02:24,100</code>
Which means that for most victims, they just sent like three or four packets over DNS</p>
<p><code>42 00:02:24,100 --&gt; 00:02:26,820</code>
over like maybe four days.</p>
<p><code>43 00:02:26,960 --&gt; 00:02:28,960</code>
So one packet per day.</p>
<p><code>44 00:02:28,960 --&gt; 00:02:30,960</code>
And I&hellip;</p>
<p><code>45 00:02:30,960 --&gt; 00:02:32,960</code>
You know, who would discover that?</p>
<p><code>46 00:02:32,960 --&gt; 00:02:34,960</code>
That would go totally under the radar, right?</p>
<p><code>47 00:02:34,960 --&gt; 00:02:35,960</code>
Yeah.</p>
<p><code>48 00:02:35,960 --&gt; 00:02:37,960</code>
And that&rsquo;s sort of what the talk is about.</p>
<p><code>49 00:02:37,960 --&gt; 00:02:41,960</code>
How they managed to stay under the radar for so long.</p>
<p><code>50 00:02:41,960 --&gt; 00:02:43,960</code>
I mean, how&hellip;</p>
<p><code>51 00:02:43,960 --&gt; 00:02:47,960</code>
What&rsquo;s the impact that you&rsquo;ve seen that when you&rsquo;re checking this message?</p>
<p><code>52 00:02:47,960 --&gt; 00:02:49,960</code>
I mean, in magnitude.</p>
<p><code>53 00:02:49,960 --&gt; 00:02:51,960</code>
How many infections?</p>
<p><code>54 00:02:51,960 --&gt; 00:02:54,960</code>
When it was active, it&rsquo;s&hellip;</p>
<p><code>55 00:02:54,960 --&gt; 00:02:56,960</code>
They got like more than a thousand.</p>
<p><code>56 00:02:56,960 --&gt; 00:03:01,960</code>
They got like a thousand new victim organizations per month.</p>
<p><code>57 00:03:01,960 --&gt; 00:03:04,960</code>
I mean, I only see part of the data.</p>
<p><code>58 00:03:04,960 --&gt; 00:03:08,960</code>
I only see what people have gathered in passive DNS traffic.</p>
<p><code>59 00:03:08,960 --&gt; 00:03:11,960</code>
I would guess it&rsquo;s probably much more than that.</p>
<p><code>60 00:03:11,960 --&gt; 00:03:15,960</code>
But at least a thousand victims per month is what they got.</p>
<p><code>61 00:03:15,960 --&gt; 00:03:21,960</code>
And they handpicked, you know, probably less than 1% of those to actually do something about.</p>
<p><code>62 00:03:21,960 --&gt; 00:03:23,960</code>
The other ones, they just shut down.</p>
<p><code>63 00:03:23,960 --&gt; 00:03:24,960</code>
Cool.</p>
<p><code>64 00:03:24,960 --&gt; 00:03:30,960</code>
What got you into analyzing this malware then?</p>
<p><code>65 00:03:30,960 --&gt; 00:03:37,960</code>
First of all, when this was published by FireEye, I realized that this&hellip;</p>
<p><code>66 00:03:37,960 --&gt; 00:03:41,960</code>
The update was actually still available from SolarWinds.</p>
<p><code>67 00:03:41,960 --&gt; 00:03:42,960</code>
So I downloaded it.</p>
<p><code>68 00:03:42,960 --&gt; 00:03:45,960</code>
And I discovered, hey, this is C-sharp code, .NET.</p>
<p><code>69 00:03:45,960 --&gt; 00:03:46,960</code>
I&rsquo;m a .NET developer.</p>
<p><code>70 00:03:46,960 --&gt; 00:03:49,960</code>
So I was like, yeah, let&rsquo;s have a peek at what is laying there.</p>
<p><code>71 00:03:49,960 --&gt; 00:03:51,960</code>
So I spent some time just looking around.</p>
<p><code>72 00:03:51,960 --&gt; 00:03:52,960</code>
It&rsquo;s like, yeah, okay.</p>
<p><code>73 00:03:52,960 --&gt; 00:03:53,960</code>
I get the general&hellip;</p>
<p><code>74 00:03:53,960 --&gt; 00:03:55,960</code>
Like what they&rsquo;re trying to do.</p>
<p><code>75 00:03:55,960 --&gt; 00:03:56,960</code>
And then&hellip;</p>
<p><code>76 00:03:56,960 --&gt; 00:04:00,960</code>
But I was like, yeah, but someone will publish a good decoder for this.</p>
<p><code>77 00:04:00,960 --&gt; 00:04:03,960</code>
Then after a while, I realized that, yeah, people publish decoders.</p>
<p><code>78 00:04:03,960 --&gt; 00:04:05,960</code>
But FireEye didn&rsquo;t do a decoder.</p>
<p><code>79 00:04:05,960 --&gt; 00:04:07,960</code>
Microsoft didn&rsquo;t do a decoder.</p>
<p><code>80 00:04:07,960 --&gt; 00:04:11,960</code>
You know, this was a guy in China who did a Python script that would decode this.</p>
<p><code>81 00:04:11,960 --&gt; 00:04:19,960</code>
I was like, yeah, but I can understand the pain trying to direct reverse encoding of .NET functions.</p>
<p><code>82 00:04:19,960 --&gt; 00:04:21,960</code>
But do it in Python.</p>
<p><code>83 00:04:21,960 --&gt; 00:04:26,960</code>
And make sure that all your output will be the exact same things as a .NET function.</p>
<p><code>84 00:04:26,960 --&gt; 00:04:30,960</code>
So for me as a .NET coder, it&rsquo;s like, this is super simple for me.</p>
<p><code>85 00:04:30,960 --&gt; 00:04:33,960</code>
I just do the exact operations they do, but in the other direction.</p>
<p><code>86 00:04:33,960 --&gt; 00:04:34,960</code>
And I&rsquo;ll decode that.</p>
<p><code>87 00:04:34,960 --&gt; 00:04:38,960</code>
So that&rsquo;s why I felt, you know, this is something we need.</p>
<p><code>88 00:04:38,960 --&gt; 00:04:40,960</code>
Because the decoding was just&hellip;</p>
<p><code>89 00:04:40,960 --&gt; 00:04:42,960</code>
It was not decryption.</p>
<p><code>90 00:04:42,960 --&gt; 00:04:43,960</code>
It was just decoding.</p>
<p><code>91 00:04:43,960 --&gt; 00:04:44,960</code>
Exactly.</p>
<p><code>92 00:04:44,960 --&gt; 00:04:49,960</code>
It was like, not base 64, but base 32 with a custom alphabet.</p>
<p><code>93 00:04:49,960 --&gt; 00:04:50,960</code>
Just that makes&hellip;</p>
<p><code>94 00:04:50,960 --&gt; 00:04:57,960</code>
I guess they used it to make sure that the output, the data they want to send, is compatible with DNS.</p>
<p><code>95 00:04:57,960 --&gt; 00:05:02,960</code>
So that they just take the data and format this into a fake subdomain.</p>
<p><code>96 00:05:02,960 --&gt; 00:05:05,960</code>
And to send it as a DNS query.</p>
<p><code>97 00:05:05,960 --&gt; 00:05:07,960</code>
So how did the&hellip;</p>
<p><code>98 00:05:07,960 --&gt; 00:05:13,960</code>
Because you said that you used your script to dive into this and analyze&hellip;</p>
<p><code>99 00:05:13,960 --&gt; 00:05:16,960</code>
Or notify the search of the different countries.</p>
<p><code>100 00:05:16,960 --&gt; 00:05:18,960</code>
How did they respond?</p>
<p><code>101 00:05:18,960 --&gt; 00:05:19,960</code>
I haven&rsquo;t got&hellip;</p>
<p><code>102 00:05:19,960 --&gt; 00:05:20,960</code>
Joy?</p>
<p><code>103 00:05:20,960 --&gt; 00:05:25,960</code>
I provided the script in some search organizations.</p>
<p><code>104 00:05:25,960 --&gt; 00:05:35,960</code>
And in some collaborative groups where people work together to help make things more secure.</p>
<p><code>105 00:05:35,960 --&gt; 00:05:37,960</code>
And I&rsquo;ve got really good support for that.</p>
<p><code>106 00:05:37,960 --&gt; 00:05:41,960</code>
People are thanking me for providing them with the tool.</p>
<p><code>107 00:05:41,960 --&gt; 00:05:43,960</code>
My tool was only part of that.</p>
<p><code>108 00:05:43,960 --&gt; 00:05:48,960</code>
A big part was all these people who actually collected the DNS data.</p>
<p><code>109 00:05:48,960 --&gt; 00:05:49,960</code>
Because my tool was useless.</p>
<p><code>110 00:05:49,960 --&gt; 00:05:52,960</code>
It was useless unless you had a lot of DNS traffic.</p>
<p><code>111 00:05:52,960 --&gt; 00:05:58,960</code>
And I was super impressed of how many people actually helped out and gathered DNS traffic.</p>
<p><code>112 00:05:58,960 --&gt; 00:06:00,960</code>
Going to these specific domains.</p>
<p><code>113 00:06:00,960 --&gt; 00:06:04,960</code>
So that victims could be identified and could be notified by the search organizations.</p>
<p><code>114 00:06:04,960 --&gt; 00:06:06,960</code>
Definitely a community effort then.</p>
<p><code>115 00:06:06,960 --&gt; 00:06:07,960</code>
Oh yes, indeed.</p>
<p><code>116 00:06:07,960 --&gt; 00:06:08,960</code>
Perfect.</p>
<p><code>117 00:06:08,960 --&gt; 00:06:10,960</code>
Let&rsquo;s not keep you off the stage.</p>
<p><code>118 00:06:10,960 --&gt; 00:06:13,960</code>
Because you will be the first likely to talk here really soon now.</p>
<p><code>119 00:06:13,960 --&gt; 00:06:14,960</code>
Yeah.</p>
<p><code>120 00:06:14,960 --&gt; 00:06:16,960</code>
Great having a chat with you.</p>
<p><code>121 00:06:16,960 --&gt; 00:06:18,960</code>
So nice to have a chat with you, Erik.</p>
<p><code>122 00:06:18,960 --&gt; 00:06:20,960</code>
It&rsquo;s a pleasure to have you over here.</p>
<p><code>123 00:06:20,960 --&gt; 00:06:21,960</code>
It&rsquo;s always nice to be here.</p>
<p><code>124 00:06:21,960 --&gt; 00:06:22,960</code>
Thank you.</p>
<p><code>125 00:06:22,960 --&gt; 00:06:23,960</code>
Thank you so much.</p>
<p><code>126 00:06:24,960 --&gt; 00:06:28,960</code>
Yes, welcome to the SECTI livestream.</p>
<p><code>127 00:06:28,960 --&gt; 00:06:29,960</code>
Is it live?</p>
<p><code>128 00:06:29,960 --&gt; 00:06:30,960</code>
Semi-live?</p>
<p><code>129 00:06:30,960 --&gt; 00:06:31,960</code>
Sort of. Semi-live.</p>
<p><code>130 00:06:31,960 --&gt; 00:06:33,960</code>
I&rsquo;m here with Rickard Bokfors.</p>
<p><code>131 00:06:33,960 --&gt; 00:06:34,960</code>
And today with Leo.</p>
<p><code>132 00:06:34,960 --&gt; 00:06:36,960</code>
And Tom, that just came off stage.</p>
<p><code>133 00:06:36,960 --&gt; 00:06:39,960</code>
You were talking about threat hunting, right?</p>
<p><code>134 00:06:39,960 --&gt; 00:06:40,960</code>
Threat intelligence.</p>
<p><code>135 00:06:40,960 --&gt; 00:06:43,960</code>
And it was a really interesting, inspiring talk.</p>
<p><code>136 00:06:43,960 --&gt; 00:06:45,960</code>
You can&rsquo;t go into any details of course.</p>
<p><code>137 00:06:45,960 --&gt; 00:06:47,960</code>
Because, yeah, for reasons.</p>
<p><code>138 00:06:47,960 --&gt; 00:06:56,960</code>
But we just agreed upon that we will actually be possible to talk a little more generic about threat intelligence and threat hunting, right?</p>
<p><code>139 00:06:56,960 --&gt; 00:06:57,960</code>
Yeah, exactly.</p>
<p><code>140 00:06:57,960 --&gt; 00:06:59,960</code>
So, happy to have you here.</p>
<p><code>141 00:06:59,960 --&gt; 00:07:00,960</code>
Yeah.</p>
<p><code>142 00:07:00,960 --&gt; 00:07:02,960</code>
Let me kick off with the first question here.</p>
<p><code>143 00:07:02,960 --&gt; 00:07:12,960</code>
You talked a lot about how you used threat intelligence to enhance your threat hunting techniques.</p>
<p><code>144 00:07:12,960 --&gt; 00:07:16,960</code>
Do you think that is something that more people should use?</p>
<p><code>145 00:07:16,960 --&gt; 00:07:20,960</code>
In terms of when they go threat hunting?</p>
<p><code>146 00:07:20,960 --&gt; 00:07:22,960</code>
Definitely.</p>
<p><code>147 00:07:22,960 --&gt; 00:07:24,960</code>
I think it&rsquo;s&hellip;</p>
<p><code>148 00:07:24,960 --&gt; 00:07:26,960</code>
We&rsquo;ll do it both.</p>
<p><code>149 00:07:26,960 --&gt; 00:07:28,960</code>
I&rsquo;ll start, you go second.</p>
<p><code>150 00:07:28,960 --&gt; 00:07:30,960</code>
Ladies first.</p>
<p><code>151 00:07:30,960 --&gt; 00:07:34,960</code>
Okay, so I think if you can do it, if you have the resources.</p>
<p><code>152 00:07:34,960 --&gt; 00:07:36,960</code>
Because of course it&rsquo;s more costly.</p>
<p><code>153 00:07:36,960 --&gt; 00:07:38,960</code>
You should do it.</p>
<p><code>154 00:07:38,960 --&gt; 00:07:42,960</code>
Because first it will help you to be more specific.</p>
<p><code>155 00:07:42,960 --&gt; 00:07:47,960</code>
And also you combine other data into the hunting itself.</p>
<p><code>156 00:07:47,960 --&gt; 00:07:50,960</code>
So you&rsquo;re more accurate on the finding.</p>
<p><code>157 00:07:50,960 --&gt; 00:07:53,960</code>
And you can actually find even more.</p>
<p><code>158 00:07:53,960 --&gt; 00:07:56,960</code>
So I think if you can do it, go ahead.</p>
<p><code>159 00:07:56,960 --&gt; 00:07:59,960</code>
And one thing important to mention that we also talked about.</p>
<p><code>160 00:07:59,960 --&gt; 00:08:05,960</code>
It is not a matter of simple hunting, I guess, or intelligent driven hunting.</p>
<p><code>161 00:08:05,960 --&gt; 00:08:07,960</code>
The best method is a combination of both.</p>
<p><code>162 00:08:07,960 --&gt; 00:08:12,960</code>
Use both the simple IOCs and also the enrichment that you can do from threat intelligence.</p>
<p><code>163 00:08:12,960 --&gt; 00:08:14,960</code>
This is the best way.</p>
<p><code>164 00:08:14,960 --&gt; 00:08:19,960</code>
Because one thing that struck my mind is that there are&hellip;</p>
<p><code>165 00:08:19,960 --&gt; 00:08:27,960</code>
It&rsquo;s a chance that you might go down the wrong rabbit hole if you assume that a certain threat actor is responsible.</p>
<p><code>166 00:08:27,960 --&gt; 00:08:31,960</code>
In the case, and we won&rsquo;t go into that.</p>
<p><code>167 00:08:31,960 --&gt; 00:08:36,960</code>
But you had indications that a certain type of threat actor was responsible.</p>
<p><code>168 00:08:36,960 --&gt; 00:08:39,960</code>
And that led you to some discoveries.</p>
<p><code>169 00:08:39,960 --&gt; 00:08:41,960</code>
But&hellip;</p>
<p><code>170 00:08:41,960 --&gt; 00:08:46,960</code>
The flip side of that is there&rsquo;s a big chance that if you assume something.</p>
<p><code>171 00:08:46,960 --&gt; 00:08:52,960</code>
You might look for corroborating evidence that will support your theories.</p>
<p><code>172 00:08:52,960 --&gt; 00:08:59,960</code>
So how do you avoid getting into this sort of information bias?</p>
<p><code>173 00:08:59,960 --&gt; 00:09:03,960</code>
So this is a very interesting question.</p>
<p><code>174 00:09:03,960 --&gt; 00:09:10,960</code>
And like you said, what we try to do when we do research is to always not to try to do the confirmation bias.</p>
<p><code>175 00:09:11,960 --&gt; 00:09:13,960</code>
And always to keep an open mind.</p>
<p><code>176 00:09:13,960 --&gt; 00:09:16,960</code>
And always to say if we find something that doesn&rsquo;t&hellip;</p>
<p><code>177 00:09:16,960 --&gt; 00:09:19,960</code>
Even if we find a few evidence that it is some threat actor.</p>
<p><code>178 00:09:19,960 --&gt; 00:09:22,960</code>
We never say 100% it is that threat actor.</p>
<p><code>179 00:09:22,960 --&gt; 00:09:25,960</code>
We always leave a window open.</p>
<p><code>180 00:09:25,960 --&gt; 00:09:33,960</code>
Because there has been instances in the past that some Russian APT described as an Iranian APT.</p>
<p><code>181 00:09:33,960 --&gt; 00:09:35,960</code>
It also happens.</p>
<p><code>182 00:09:35,960 --&gt; 00:09:40,960</code>
So of course if we find several evidence that it is a threat actor.</p>
<p><code>183 00:09:40,960 --&gt; 00:09:42,960</code>
Maybe with a high certainty.</p>
<p><code>184 00:09:42,960 --&gt; 00:09:46,960</code>
It is Kim Suk-ho or it is APT 37 or something like that.</p>
<p><code>185 00:09:46,960 --&gt; 00:09:47,960</code>
But never like&hellip;</p>
<p><code>186 00:09:47,960 --&gt; 00:09:50,960</code>
It&rsquo;s definitely, definitely, definitely no&hellip;</p>
<p><code>187 00:09:50,960 --&gt; 00:09:51,960</code>
It&rsquo;s always like&hellip;</p>
<p><code>188 00:09:51,960 --&gt; 00:09:52,960</code>
Corroborate that.</p>
<p><code>189 00:09:52,960 --&gt; 00:09:54,960</code>
Yeah, exactly.</p>
<p><code>190 00:09:54,960 --&gt; 00:09:56,960</code>
I think that&rsquo;s a good plan.</p>
<p><code>191 00:09:56,960 --&gt; 00:10:01,960</code>
Yeah, because in the previous talks we also see that as an attacker you leave&hellip;</p>
<p><code>192 00:10:01,960 --&gt; 00:10:03,960</code>
False flags.</p>
<p><code>193 00:10:03,960 --&gt; 00:10:08,960</code>
The threat incident responders, they will find some Monero miner and then&hellip;</p>
<p><code>194 00:10:08,960 --&gt; 00:10:10,960</code>
Oh, that was Monero miner.</p>
<p><code>195 00:10:10,960 --&gt; 00:10:11,960</code>
Good. Case closed.</p>
<p><code>196 00:10:11,960 --&gt; 00:10:13,960</code>
Move on to the next one, right?</p>
<p><code>197 00:10:13,960 --&gt; 00:10:17,960</code>
Yeah, also you can have sometimes different attackers in the same environment.</p>
<p><code>198 00:10:17,960 --&gt; 00:10:20,960</code>
So you have to distinguish between different clusters.</p>
<p><code>199 00:10:20,960 --&gt; 00:10:21,960</code>
Exactly.</p>
<p><code>200 00:10:21,960 --&gt; 00:10:24,960</code>
So it&rsquo;s also very important.</p>
<p><code>201 00:10:24,960 --&gt; 00:10:27,960</code>
We&rsquo;re not here to talk about me but I&hellip;</p>
<p><code>202 00:10:27,960 --&gt; 00:10:29,960</code>
But let&rsquo;s do it.</p>
<p><code>203 00:10:29,960 --&gt; 00:10:38,960</code>
I was on one case where we had indications that a customer was attacked by&hellip;</p>
<p><code>204 00:10:38,960 --&gt; 00:10:40,960</code>
A sergeant.</p>
<p><code>205 00:10:40,960 --&gt; 00:10:43,960</code>
A sergeant is a certain type of attacker.</p>
<p><code>206 00:10:43,960 --&gt; 00:10:45,960</code>
But what we saw was that there was&hellip;</p>
<p><code>207 00:10:45,960 --&gt; 00:10:51,960</code>
When we did a thorough investigation was that they had been attacked way before that.</p>
<p><code>208 00:10:51,960 --&gt; 00:10:58,960</code>
And then once they were done, they basically sold the access to some script kitty who trashed</p>
<p><code>209 00:10:58,960 --&gt; 00:11:03,960</code>
a lot of evidence just by using all kinds of script kitty tools.</p>
<p><code>210 00:11:03,960 --&gt; 00:11:09,960</code>
And that way, you know, if we&rsquo;d been sloppy, we would have just found the obvious.</p>
<p><code>211 00:11:09,960 --&gt; 00:11:17,960</code>
Men när vi dök in mer så såg vi att det fanns evidens av en annan rådgivare som var där tidigare.</p>
<p><code>212 00:11:18,380 --&gt; 00:11:22,280</code>
Och möjligen gav av sig den här tillgången till rådgivare.</p>
<p><code>213 00:11:23,360 --&gt; 00:11:27,140</code>
Är det något som du har sett när du har jobbat med klienter?</p>
<p><code>214 00:11:27,260 --&gt; 00:11:28,800</code>
Det är faktiskt roligt att du frågar.</p>
<p><code>215 00:11:29,820 --&gt; 00:11:33,100</code>
Vi har just utföljt en månad sedan en forskning.</p>
<p><code>216 00:11:33,600 --&gt; 00:11:38,560</code>
Vi har hittat tre olika kinesiska APT-grupper på en enkel område.</p>
<p><code>217 00:11:38,560 --&gt; 00:11:46,880</code>
Och som du sa så har vi haft en grupp som har stöttat ett par år senare och sen en annan grupp och sen en annan grupp.</p>
<p><code>218 00:11:47,880 --&gt; 00:11:51,380</code>
Så vi måste utfölja de olika klusterna och arbeta med det.</p>
<p><code>219 00:11:51,400 --&gt; 00:11:55,300</code>
Men det är något som vi fortsätter att se på olika kunder.</p>
<p><code>220 00:11:55,900 --&gt; 00:12:00,520</code>
Om det är en intressant kund så skulle många människor vilja stötta dem.</p>
<p><code>221 00:12:01,120 --&gt; 00:12:08,240</code>
Vad som är intressant med den här historien är att vi bara uppfattade en direktaktör och såg att det var en direktaktör.</p>
<p><code>222 00:12:08,560 --&gt; 00:12:15,100</code>
Men vi kände att det inte var en direktaktör och såg att det var en annan aktivitet.</p>
<p><code>223 00:12:15,400 --&gt; 00:12:18,820</code>
Och på de här maskinerna såg det ut som något helt annat.</p>
<p><code>224 00:12:19,180 --&gt; 00:12:25,120</code>
Så efter att vi utföljde det såg vi att det var flera direktaktörer inom miljön.</p>
<p><code>225 00:12:25,480 --&gt; 00:12:28,300</code>
Och det är något som du inte kan samla in i ett verktyg.</p>
<p><code>226 00:12:28,560 --&gt; 00:12:32,000</code>
Du behöver erfarenhet och det är en känsla att något inte är rätt.</p>
<p><code>227 00:12:32,740 --&gt; 00:12:34,000</code>
Alla saker som händer här.</p>
<p><code>228 00:12:34,520 --&gt; 00:12:37,100</code>
Det är därför du behöver den intressanta intressant aspekten av det.</p>
<p><code>229 00:12:37,100 --&gt; 00:12:42,540</code>
För IR kan ge dig mycket evidens och artefakter och riktigt coola saker.</p>
<p><code>230 00:12:42,540 --&gt; 00:12:47,540</code>
Men du behöver den andra aspekten av threat intelligence för att förstå vad du tittar på.</p>
<p><code>231 00:12:48,260 --&gt; 00:12:52,460</code>
Attribution är vanligtvis en riktigt svår utmaning.</p>
<p><code>232 00:12:53,600 --&gt; 00:12:55,780</code>
Särskilt om det finns flera personer inne i det.</p>
<p><code>233 00:12:55,780 --&gt; 00:12:57,380</code>
Eller har varit det över tid.</p>
<p><code>234 00:12:59,380 --&gt; 00:13:04,580</code>
Kan du säga att det finns en bra sätt att arbeta med förväntning?</p>
<p><code>235 00:13:04,660 --&gt; 00:13:06,540</code>
Jag menar threat intelligence.</p>
<p><code>236 00:13:06,540 --&gt; 00:13:12,940</code>
Att använda threat intelligence som ditt förväntningsverktyg för att det kommer att hända problem i framtiden.</p>
<p><code>237 00:13:12,940 --&gt; 00:13:16,640</code>
Eller hur kan du använda threat intelligence för att förvänta dig vad som händer?</p>
<p><code>238 00:13:16,640 --&gt; 00:13:24,300</code>
Jag tror att istället för att förvänta dig att det kommer att hända problem så kan du försöka förvänta dig vem som är intresserad av att attackera dig.</p>
<p><code>239 00:13:24,840 --&gt; 00:13:36,100</code>
Om du jobbar i en flygplats eller försöker se vilken typ av APT som brukar attackera din typ av jord.</p>
<p><code>240 00:13:36,540 --&gt; 00:13:39,360</code>
Om du jobbar i en flygplats eller försöker se vilken typ av jord.</p>
<p><code>241 00:13:39,360 --&gt; 00:13:42,300</code>
Om du jobbar i en flygplats eller försöker se vilken typ av jord.</p>
<p><code>242 00:13:42,300 --&gt; 00:13:50,060</code>
Då kan du förvänta dig att det kan vara Iraner, russar eller andra.</p>
<p><code>243 00:13:50,060 --&gt; 00:13:56,540</code>
Du kan göra en stor del av din forskning på den typen av APT för att kunna ta hand om det.</p>
<p><code>244 00:13:59,840 --&gt; 00:14:05,640</code>
En ting som ni pratade om var hur man kan börja med det.</p>
<p><code>245 00:14:05,640 --&gt; 00:14:05,980</code>
En ting som ni pratade om var hur man kan börja med det.</p>
<p><code>246 00:14:05,980 --&gt; 00:14:06,240</code>
En ting som ni pratade om var hur man kan börja med det.</p>
<p><code>247 00:14:06,240 --&gt; 00:14:12,440</code>
att börja ut och en av rörelserna var att börja liten, börja med en</p>
<p><code>248 00:14:12,440 --&gt; 00:14:18,440</code>
liten antal grupper när du börjar göra</p>
<p><code>249 00:14:18,440 --&gt; 00:14:24,240</code>
threat intelligence. Men vad annars kan du säga är viktigt när</p>
<p><code>250 00:14:24,240 --&gt; 00:14:27,740</code>
du vill börja använda threat intelligence på ett</p>
<p><code>251 00:14:27,740 --&gt; 00:14:34,140</code>
mångfaldigt sätt. Jag tror att en sak är att alltid tänka på dig själv.</p>
<p><code>252 00:14:34,140 --&gt; 00:14:37,440</code>
Kanske är du på fel väg.</p>
<p><code>253 00:14:37,440 --&gt; 00:14:42,780</code>
Var alltid tillbaka till början och se om det</p>
<p><code>254 00:14:42,780 --&gt; 00:14:44,140</code>
passar vad du gör.</p>
<p><code>255 00:14:44,140 --&gt; 00:14:49,740</code>
Gå och försöka förbättra dig själv och trycka om det är en hantkvara som du gör.</p>
<p><code>256 00:14:49,740 --&gt; 00:14:53,140</code>
Pröva att trycka på dem och göra dem mer precis.</p>
<p><code>257 00:14:53,140 --&gt; 00:14:57,440</code>
Och sen när du börjar med det smala</p>
<p><code>258 00:14:57,440 --&gt; 00:15:01,840</code>
och du är säker på vad du har, kan du gå lite större och se</p>
<p><code>259 00:15:01,840 --&gt; 00:15:05,140</code>
kanske andra saker. Men återigen, du måste gå tillbaka till början och</p>
<p><code>260 00:15:05,140 --&gt; 00:15:09,040</code>
säkra att du fortfarande är på rätt väg så att du inte går till</p>
<p><code>261 00:15:09,040 --&gt; 00:15:15,440</code>
rörelsehållet. Och det är det jag tycker. Som Asaf nämnde i presentationen,</p>
<p><code>262 00:15:15,440 --&gt; 00:15:18,940</code>
det är inte en linjär väg. Du måste ibland gå tillbaka och</p>
<p><code>263 00:15:18,940 --&gt; 00:15:20,840</code>
tycka på dig själv.</p>
<p><code>264 00:15:20,840 --&gt; 00:15:25,240</code>
Cool. Så strikt metodologi är kvarten?</p>
<p><code>265 00:15:25,240 --&gt; 00:15:27,340</code>
Jag tror, jag menar du kan säga så.</p>
<p><code>266 00:15:27,340 --&gt; 00:15:31,140</code>
Det är väldigt strikt, men ibland måste du förändra det efter vad du gör.</p>
<p><code>267 00:15:31,140 --&gt; 00:15:38,940</code>
Vi började med det basala och sen efter att vi gjorde Kimsuki-forskning så förändrade vi</p>
<p><code>268 00:15:38,940 --&gt; 00:15:41,940</code>
det lite och gjorde det mer tillgängligt med vad vi gör.</p>
<p><code>269 00:15:41,940 --&gt; 00:15:49,540</code>
Men om du har en lista av saker som är hjälpande för dig, så gå över dem.</p>
<p><code>270 00:15:49,540 --&gt; 00:15:51,340</code>
Det är hjälpfullt i undersökningen.</p>
<p><code>271 00:15:51,340 --&gt; 00:15:52,940</code>
Coolt.</p>
<p><code>272 00:15:52,940 --&gt; 00:15:56,540</code>
Vi håller inte på att hålla dig till.</p>
<p><code>273 00:15:56,540 --&gt; 00:15:58,540</code>
Tack för att du gillade resten av konferensen.</p>
<p><code>274 00:15:58,540 --&gt; 00:16:02,040</code>
Tack så mycket. Det var en väldigt intressant talning och tack för att du tog dig</p>
<p><code>275 00:16:02,040 --&gt; 00:16:03,140</code>
tid att prata med oss.</p>
<p><code>276 00:16:03,140 --&gt; 00:16:06,140</code>
Ja, du och Tom, tack för att du har haft oss.</p>
<p><code>277 00:16:06,140 --&gt; 00:16:08,740</code>
Ha en fin dag och ha en fin dag här i Stockholm.</p>
<p><code>278 00:16:08,740 --&gt; 00:16:11,140</code>
Tack så mycket.</p>
<p><code>279 00:16:11,140 --&gt; 00:16:23,340</code>
Så välkomna till Säkerhetspodcasten på Säkté och nu har vi lyssnat på din</p>
<p><code>280 00:16:23,340 --&gt; 00:16:24,340</code>
fantastiska talning här.</p>
<p><code>281 00:16:24,340 --&gt; 00:16:30,940</code>
Mark och Aaron, sorry about that, I forgot your name.</p>
<p><code>282 00:16:30,940 --&gt; 00:16:38,140</code>
You were talking about fuzzing drivers which is of course a very, very hard</p>
<p><code>283 00:16:38,140 --&gt; 00:16:47,740</code>
topic and you sort of explained how to automate the process to cover a lot of</p>
<p><code>284 00:16:47,740 --&gt; 00:16:51,740</code>
ground without doing too much of legwork.</p>
<p><code>285 00:16:51,740 --&gt; 00:16:53,740</code>
So could you just briefly explain what legwork is?</p>
<p><code>286 00:16:54,340 --&gt; 00:17:00,940</code>
How do you start taking on something like that?</p>
<p><code>287 00:17:00,940 --&gt; 00:17:04,940</code>
Well, I guess one of the things that drives us and the whole humanity as well is that</p>
<p><code>288 00:17:04,940 --&gt; 00:17:08,940</code>
we&rsquo;re lazy and we want to work as less as possible.</p>
<p><code>289 00:17:08,940 --&gt; 00:17:15,940</code>
Other than that, we&rsquo;ve gathered quite a lot of knowledge about Windows drivers in</p>
<p><code>290 00:17:15,940 --&gt; 00:17:20,940</code>
general and not so long ago KFL came to existence.</p>
<p><code>291 00:17:20,940 --&gt; 00:17:22,940</code>
So the natural thing for us was to see how Windows drivers work.</p>
<p><code>292 00:17:22,940 --&gt; 00:17:28,540</code>
So the natural thing for us was to see how we can use the knowledge we have both on</p>
<p><code>293 00:17:28,540 --&gt; 00:17:33,540</code>
fuzzers and on drivers and of course attack them as a target.</p>
<p><code>294 00:17:33,540 --&gt; 00:17:40,540</code>
Of course there are many problems on the way but at least we had a point to start from.</p>
<p><code>295 00:17:40,540 --&gt; 00:17:41,540</code>
Cool.</p>
<p><code>296 00:17:41,540 --&gt; 00:17:50,940</code>
But starting with fuzzing drivers, that&rsquo;s really hard because you get blue screens and</p>
<p><code>297 00:17:50,940 --&gt; 00:17:51,940</code>
then you&rsquo;re done.</p>
<p><code>298 00:17:51,940 --&gt; 00:17:52,940</code>
Yeah.</p>
<p><code>299 00:17:52,940 --&gt; 00:17:56,940</code>
But blue screens are a good thing with fuzzing drivers because if you manage to find the</p>
<p><code>300 00:17:56,940 --&gt; 00:17:58,940</code>
blue screens it means you find a bug.</p>
<p><code>301 00:17:58,940 --&gt; 00:18:02,940</code>
Later on you understand the implications of the blue screen and if you can exploit it</p>
<p><code>302 00:18:02,940 --&gt; 00:18:08,940</code>
further on to run your payload in the kernel or do some other types of elevation of privilege</p>
<p><code>303 00:18:08,940 --&gt; 00:18:09,940</code>
attacks.</p>
<p><code>304 00:18:09,940 --&gt; 00:18:12,940</code>
But if we got a blue screen, we are very happy.</p>
<p><code>305 00:18:12,940 --&gt; 00:18:13,940</code>
Cool.</p>
<p><code>306 00:18:13,940 --&gt; 00:18:19,940</code>
So I missed the beginning of your talk due to crew duties.</p>
<p><code>307 00:18:19,940 --&gt; 00:18:21,940</code>
But it&rsquo;s pretty cool.</p>
<p><code>308 00:18:21,940 --&gt; 00:18:28,940</code>
Is my understanding correct that you built a big test harness upon KFL and some other</p>
<p><code>309 00:18:28,940 --&gt; 00:18:30,940</code>
things to fuzz drivers?</p>
<p><code>310 00:18:30,940 --&gt; 00:18:32,940</code>
That&rsquo;s basically the concept here.</p>
<p><code>311 00:18:32,940 --&gt; 00:18:33,940</code>
Yeah.</p>
<p><code>312 00:18:33,940 --&gt; 00:18:34,940</code>
Correct.</p>
<p><code>313 00:18:34,940 --&gt; 00:18:41,940</code>
Take the knowledge of manual reverse engineering and the knowledge of how the kernel treats</p>
<p><code>314 00:18:41,940 --&gt; 00:18:47,940</code>
drivers and specifically speaking the IO manager and later trying to generalize it and do some</p>
<p><code>315 00:18:47,940 --&gt; 00:18:50,940</code>
things automatically.</p>
<p><code>316 00:18:50,940 --&gt; 00:18:57,940</code>
And the end game here, fun and profit or are you hunting for bug bounty?</p>
<p><code>317 00:18:57,940 --&gt; 00:18:59,940</code>
Is this more for the fun of it?</p>
<p><code>318 00:18:59,940 --&gt; 00:19:00,940</code>
Yeah.</p>
<p><code>319 00:19:00,940 --&gt; 00:19:01,940</code>
Mostly fun and profit.</p>
<p><code>320 00:19:01,940 --&gt; 00:19:05,940</code>
We do research for white hat perspectives.</p>
<p><code>321 00:19:05,940 --&gt; 00:19:06,940</code>
Yeah.</p>
<p><code>322 00:19:06,940 --&gt; 00:19:07,940</code>
Mostly.</p>
<p><code>323 00:19:07,940 --&gt; 00:19:08,940</code>
Yeah.</p>
<p><code>324 00:19:08,940 --&gt; 00:19:17,940</code>
So you outline your methodology and what you&rsquo;re looking for and when to sort of step</p>
<p><code>325 00:19:17,940 --&gt; 00:19:19,940</code>
away from something.</p>
<p><code>326 00:19:19,940 --&gt; 00:19:20,940</code>
We&rsquo;re done with that.</p>
<p><code>327 00:19:20,940 --&gt; 00:19:22,940</code>
We&rsquo;re not even going to look at that.</p>
<p><code>328 00:19:22,940 --&gt; 00:19:29,940</code>
But I mean the work in sort of understanding what you should be looking for.</p>
<p><code>329 00:19:29,940 --&gt; 00:19:32,940</code>
I mean that must have been very tedious work.</p>
<p><code>330 00:19:32,940 --&gt; 00:19:33,940</code>
Yeah.</p>
<p><code>331 00:19:33,940 --&gt; 00:19:38,940</code>
We needed to understand how drivers work in a very deep level in Windows.</p>
<p><code>332 00:19:38,940 --&gt; 00:19:42,940</code>
And this is also holds merit to other operating system as well.</p>
<p><code>333 00:19:42,940 --&gt; 00:19:43,940</code>
Yeah.</p>
<p><code>334 00:19:43,940 --&gt; 00:19:45,940</code>
If you try to find bugs in them.</p>
<p><code>335 00:19:45,940 --&gt; 00:19:46,940</code>
Yeah.</p>
<p><code>336 00:19:46,940 --&gt; 00:19:47,940</code>
Because I mean before you start automating.</p>
<p><code>337 00:19:47,940 --&gt; 00:19:48,940</code>
You need to understand that.</p>
<p><code>338 00:19:48,940 --&gt; 00:19:50,940</code>
You need to understand the manual process.</p>
<p><code>339 00:19:50,940 --&gt; 00:19:51,940</code>
Of course.</p>
<p><code>340 00:19:51,940 --&gt; 00:19:55,940</code>
And we just showcased in our talk around five, six different bugs.</p>
<p><code>341 00:19:55,940 --&gt; 00:19:56,940</code>
Yeah.</p>
<p><code>342 00:19:56,940 --&gt; 00:20:01,940</code>
But there are a lot more like there are multiple different things that you, things that can</p>
<p><code>343 00:20:01,940 --&gt; 00:20:02,940</code>
go wrong in the kernel.</p>
<p><code>344 00:20:02,940 --&gt; 00:20:03,940</code>
Yeah.</p>
<p><code>345 00:20:03,940 --&gt; 00:20:08,940</code>
So you must have a very keen eye also as a researcher and mostly as a developer if</p>
<p><code>346 00:20:08,940 --&gt; 00:20:10,940</code>
you want to find those bugs.</p>
<p><code>347 00:20:10,940 --&gt; 00:20:11,940</code>
Right.</p>
<p><code>348 00:20:11,940 --&gt; 00:20:16,940</code>
So let&rsquo;s say that you wanted to look for kernel security bugs.</p>
<p><code>349 00:20:16,940 --&gt; 00:20:23,940</code>
And maybe use your test harness or something.</p>
<p><code>350 00:20:23,940 --&gt; 00:20:31,140</code>
Is there any logic to which would be the easiest and most interesting drivers to find bugs</p>
<p><code>351 00:20:31,140 --&gt; 00:20:37,940</code>
in or is it just pick at random and like are some much easier to test?</p>
<p><code>352 00:20:37,940 --&gt; 00:20:38,940</code>
Yeah.</p>
<p><code>353 00:20:38,940 --&gt; 00:20:40,940</code>
There are probably some guidelines that could help you.</p>
<p><code>354 00:20:40,940 --&gt; 00:20:45,940</code>
Well, first of all, it&rsquo;s important to choose the platform because if it&rsquo;s a closed source</p>
<p><code>355 00:20:45,940 --&gt; 00:20:50,940</code>
platform in its nature and the drivers are closed source, it&rsquo;s more likely that no</p>
<p><code>356 00:20:50,940 --&gt; 00:20:55,940</code>
one tried to fuzz them and look for vulnerabilities in the first place.</p>
<p><code>357 00:20:55,940 --&gt; 00:20:57,940</code>
So that&rsquo;s one thing that could help you.</p>
<p><code>358 00:20:57,940 --&gt; 00:21:02,940</code>
Another thing is choosing the specific natures of the drivers itself.</p>
<p><code>359 00:21:02,940 --&gt; 00:21:10,940</code>
So one of the things we want, which is crucial to us, is the ability for an unprivileged user,</p>
<p><code>360 00:21:10,940 --&gt; 00:21:13,940</code>
a weak user, to be able to interact with those drivers.</p>
<p><code>361 00:21:13,940 --&gt; 00:21:14,940</code>
Other than that.</p>
<p><code>362 00:21:14,940 --&gt; 00:21:20,940</code>
We want to look for drivers that do a lot of stuff with inputs and parsing.</p>
<p><code>363 00:21:20,940 --&gt; 00:21:24,940</code>
Besides that, we didn&rsquo;t cover it because we did not have enough time.</p>
<p><code>364 00:21:24,940 --&gt; 00:21:31,940</code>
We can look for suspicious APIs like your memset and memcopy APIs that in those places</p>
<p><code>365 00:21:31,940 --&gt; 00:21:33,940</code>
most of the bugs actually take place.</p>
<p><code>366 00:21:33,940 --&gt; 00:21:38,940</code>
So if we wrap everything together, these are the top contenders.</p>
<p><code>367 00:21:38,940 --&gt; 00:21:43,940</code>
And we just looked for mostly things that you have out of the box that are not for the party.</p>
<p><code>368 00:21:43,940 --&gt; 00:21:52,940</code>
Because as you go further away from Microsoft standards, the quality of code is a lot less.</p>
<p><code>369 00:21:52,940 --&gt; 00:21:55,940</code>
Less good than Microsoft&rsquo;s own.</p>
<p><code>370 00:21:55,940 --&gt; 00:22:03,940</code>
And one thing that I was thinking about in your methodology, you used feedback loops</p>
<p><code>371 00:22:03,940 --&gt; 00:22:11,940</code>
into your fussing engine to sort of target your fussing in an intelligent way.</p>
<p><code>372 00:22:11,940 --&gt; 00:22:16,940</code>
And also you were talking about grammar.</p>
<p><code>373 00:22:16,940 --&gt; 00:22:23,940</code>
You were using sort of the constraints of what the input should look like.</p>
<p><code>374 00:22:23,940 --&gt; 00:22:28,940</code>
One question that popped into my mind regarding grammar.</p>
<p><code>375 00:22:28,940 --&gt; 00:22:32,940</code>
Wouldn&rsquo;t that potentially limit the fuzzer?</p>
<p><code>376 00:22:32,940 --&gt; 00:22:38,940</code>
So it&rsquo;s a great question and I think that&rsquo;s like the main challenge with grammars.</p>
<p><code>377 00:22:38,940 --&gt; 00:22:41,940</code>
You do want to point the fuzzer to the right direction.</p>
<p><code>378 00:22:41,940 --&gt; 00:22:45,940</code>
But you don&rsquo;t want to make it so that you miss a lot of important stuff.</p>
<p><code>379 00:22:45,940 --&gt; 00:22:54,940</code>
So that&rsquo;s part of the reason we did not want to use the classical method of structure aware of fuzzers.</p>
<p><code>380 00:22:54,940 --&gt; 00:22:56,940</code>
Because again, they are too limiting.</p>
<p><code>381 00:22:56,940 --&gt; 00:23:01,940</code>
And the reason they are too limiting is that they are not very flexible.</p>
<p><code>382 00:23:01,940 --&gt; 00:23:08,940</code>
And the method we employ, which is based on some of the latest additions to KFL,</p>
<p><code>383 00:23:08,940 --&gt; 00:23:13,940</code>
they actually allow you to mutate and change the grammar as you go.</p>
<p><code>384 00:23:13,940 --&gt; 00:23:22,940</code>
So for example, even if at some point you created such input that made it so that you missed lots of important parts,</p>
<p><code>385 00:23:22,940 --&gt; 00:23:24,940</code>
not all is lost.</p>
<p><code>386 00:23:24,940 --&gt; 00:23:30,940</code>
It is very likely that in a few more iterations later, once you see you don&rsquo;t get more code coverage,</p>
<p><code>387 00:23:30,940 --&gt; 00:23:34,940</code>
you will change your strategy and then the grammar can adapt itself.</p>
<p><code>388 00:23:34,940 --&gt; 00:23:35,940</code>
Yeah.</p>
<p><code>389 00:23:35,940 --&gt; 00:23:43,940</code>
So if you combine the two of fuzzing and smart grammar alongside some manual reverse engineering,</p>
<p><code>390 00:23:43,940 --&gt; 00:23:46,940</code>
you can improve your grammar on the fly, mostly.</p>
<p><code>391 00:23:46,940 --&gt; 00:23:47,940</code>
Right.</p>
<p><code>392 00:23:47,940 --&gt; 00:23:51,940</code>
One thing that, I mean, I&rsquo;m not into kernel stuff,</p>
<p><code>393 00:23:51,940 --&gt; 00:23:58,940</code>
but one thing that I couldn&rsquo;t quite wrap my head around was how did you detect code coverage?</p>
<p><code>394 00:23:58,940 --&gt; 00:24:05,940</code>
So the detection of code coverage is pretty much built into the early versions</p>
<p><code>395 00:24:05,940 --&gt; 00:24:10,940</code>
of AFL and as far as I&rsquo;m aware of it did not change much.</p>
<p><code>396 00:24:10,940 --&gt; 00:24:15,940</code>
But the main idea behind it is to use a very small optimized structure such as a bitmap,</p>
<p><code>397 00:24:15,940 --&gt; 00:24:18,940</code>
which is basically a multidimensional array.</p>
<p><code>398 00:24:18,940 --&gt; 00:24:25,940</code>
And each cell in that bitmap, it represents a hub from one code block to another.</p>
<p><code>399 00:24:25,940 --&gt; 00:24:32,940</code>
And the actual value of the bitmap is how many times you encounter that hub.</p>
<p><code>400 00:24:32,940 --&gt; 00:24:33,940</code>
So yes.</p>
<p><code>401 00:24:33,940 --&gt; 00:24:35,940</code>
So the idea is that</p>
<p><code>402 00:24:35,940 --&gt; 00:24:39,940</code>
by using the, by hooking the code blocks themselves,</p>
<p><code>403 00:24:39,940 --&gt; 00:24:43,940</code>
the fuzzer gets an update each time it discovers a new code block.</p>
<p><code>404 00:24:43,940 --&gt; 00:24:46,940</code>
So the bigger the bitmap gets, the more code coverage.</p>
<p><code>405 00:24:46,940 --&gt; 00:24:50,940</code>
So it&rsquo;s basically a state machine, but in our case, because we dealt with kernel code,</p>
<p><code>406 00:24:50,940 --&gt; 00:24:52,940</code>
we needed to use Intel PT.</p>
<p><code>407 00:24:52,940 --&gt; 00:24:53,940</code>
Yeah.</p>
<p><code>408 00:24:53,940 --&gt; 00:24:58,940</code>
And of course there is an AMD counterpart if you have an AMD machine, but we have Intel.</p>
<p><code>409 00:24:58,940 --&gt; 00:24:59,940</code>
Cool.</p>
<p><code>410 00:24:59,940 --&gt; 00:25:00,940</code>
Yeah.</p>
<p><code>411 00:25:00,940 --&gt; 00:25:01,940</code>
Awesome.</p>
<p><code>412 00:25:01,940 --&gt; 00:25:04,940</code>
Well, would you guys, you know,</p>
<p><code>413 00:25:04,940 --&gt; 00:25:10,940</code>
any sort of tips to young people or budding security engineers</p>
<p><code>414 00:25:10,940 --&gt; 00:25:16,940</code>
who want to get into kernel mode fuzzing or driver fuzzing?</p>
<p><code>415 00:25:16,940 --&gt; 00:25:17,940</code>
What would that be?</p>
<p><code>416 00:25:17,940 --&gt; 00:25:22,940</code>
So I think, first of all, many of the blocks are a little bit mental</p>
<p><code>417 00:25:22,940 --&gt; 00:25:25,940</code>
because it sounds like both fuzzing and drivers, they sound scary.</p>
<p><code>418 00:25:25,940 --&gt; 00:25:27,940</code>
So maybe that&rsquo;s one of the things.</p>
<p><code>419 00:25:27,940 --&gt; 00:25:32,940</code>
Another thing is that what&rsquo;s really cool about drivers and specifically iOctos,</p>
<p><code>420 00:25:32,940 --&gt; 00:25:35,940</code>
that pretty much any operating system has them.</p>
<p><code>421 00:25:35,940 --&gt; 00:25:38,940</code>
Windows has them, Linux has them, Android has them.</p>
<p><code>422 00:25:38,940 --&gt; 00:25:42,940</code>
So once you understand the gist of it and you understand the methodology,</p>
<p><code>423 00:25:42,940 --&gt; 00:25:44,940</code>
especially if you have a way to automate it,</p>
<p><code>424 00:25:44,940 --&gt; 00:25:48,940</code>
that you can do a lot of work at some point,</p>
<p><code>425 00:25:48,940 --&gt; 00:25:55,940</code>
but then you can employ much of the same setup against other targets,</p>
<p><code>426 00:25:55,940 --&gt; 00:25:57,940</code>
which is kind of cool in my opinion.</p>
<p><code>427 00:25:57,940 --&gt; 00:26:01,940</code>
To strengthen this point, the main vulnerability area</p>
<p><code>428 00:26:01,940 --&gt; 00:26:06,940</code>
that we&rsquo;ve encountered and also in bug bounty on bug hunting in general</p>
<p><code>429 00:26:06,940 --&gt; 00:26:09,940</code>
is how things have been parsed and used.</p>
<p><code>430 00:26:09,940 --&gt; 00:26:13,940</code>
So if you know that an iOcto communication channel also exists</p>
<p><code>431 00:26:13,940 --&gt; 00:26:18,940</code>
on different operating systems, then this is the place you start looking for.</p>
<p><code>432 00:26:18,940 --&gt; 00:26:24,940</code>
And you can do this by reading a blog, viewing a talk,</p>
<p><code>433 00:26:24,940 --&gt; 00:26:30,940</code>
or just disassemble some random driver and see how things go with a debugger.</p>
<p><code>434 00:26:30,940 --&gt; 00:26:36,940</code>
That&rsquo;s how I suggest people to get into this type of research.</p>
<p><code>435 00:26:36,940 --&gt; 00:26:43,940</code>
Also, I can imagine that during your work,</p>
<p><code>436 00:26:43,940 --&gt; 00:26:47,940</code>
you&rsquo;ve come across quite a lot of serious bugs.</p>
<p><code>437 00:26:47,940 --&gt; 00:26:56,940</code>
And still, you must have only sort of scratched the top of the iceberg, so to speak.</p>
<p><code>438 00:26:56,940 --&gt; 00:26:59,940</code>
Do you think there will be, like,</p>
<p><code>439 00:27:00,940 --&gt; 00:27:05,940</code>
a flood of new discoveries within drivers?</p>
<p><code>440 00:27:05,940 --&gt; 00:27:08,940</code>
I mean, we&rsquo;ve seen a couple of very public ones lately,</p>
<p><code>441 00:27:08,940 --&gt; 00:27:12,940</code>
but what do you think about the future of drivers?</p>
<p><code>442 00:27:12,940 --&gt; 00:27:14,940</code>
Well, of course it&rsquo;s very hard to predict,</p>
<p><code>443 00:27:14,940 --&gt; 00:27:17,940</code>
but I think it&rsquo;s quite plausible to assume that.</p>
<p><code>444 00:27:17,940 --&gt; 00:27:22,940</code>
And again, because of the fact that many of the driver code is legacy code.</p>
<p><code>445 00:27:22,940 --&gt; 00:27:24,940</code>
So it means two things.</p>
<p><code>446 00:27:24,940 --&gt; 00:27:28,940</code>
One, it&rsquo;s quite old, before the programmers were more aware.</p>
<p><code>447 00:27:28,940 --&gt; 00:27:30,940</code>
Hopefully they&rsquo;re more aware today.</p>
<p><code>448 00:27:30,940 --&gt; 00:27:35,940</code>
The other thing is that it probably did not go through modern CI, CD, QAs,</p>
<p><code>449 00:27:35,940 --&gt; 00:27:38,940</code>
like fuzzing on the fly and things like that.</p>
<p><code>450 00:27:38,940 --&gt; 00:27:42,940</code>
So currently there&rsquo;s still sort of a barrier to do it,</p>
<p><code>451 00:27:42,940 --&gt; 00:27:45,940</code>
whether it&rsquo;s technological or, again, mental.</p>
<p><code>452 00:27:45,940 --&gt; 00:27:50,940</code>
But I personally do believe that once this barrier gets broken,</p>
<p><code>453 00:27:50,940 --&gt; 00:27:52,940</code>
we&rsquo;ll see more of those.</p>
<p><code>454 00:27:52,940 --&gt; 00:27:55,940</code>
Additionally, driver developers are pretty rare breed.</p>
<p><code>455 00:27:55,940 --&gt; 00:27:59,940</code>
Actually, I reckon it&rsquo;s more difficult to develop a driver properly,</p>
<p><code>456 00:28:00,940 --&gt; 00:28:02,940</code>
than to find bugs in it.</p>
<p><code>457 00:28:02,940 --&gt; 00:28:05,940</code>
And some of the guys are getting older and changed positions,</p>
<p><code>458 00:28:05,940 --&gt; 00:28:07,940</code>
so it&rsquo;s very difficult for a company,</p>
<p><code>459 00:28:07,940 --&gt; 00:28:10,940</code>
even a company that is willing to pay top dollar,</p>
<p><code>460 00:28:10,940 --&gt; 00:28:13,940</code>
to get a decent driver developer.</p>
<p><code>461 00:28:13,940 --&gt; 00:28:15,940</code>
So it increases the chances.</p>
<p><code>462 00:28:15,940 --&gt; 00:28:18,940</code>
So that&rsquo;s kind of a miserable outlook.</p>
<p><code>463 00:28:18,940 --&gt; 00:28:20,940</code>
It depends on your point of view.</p>
<p><code>464 00:28:20,940 --&gt; 00:28:22,940</code>
Yeah, exactly.</p>
<p><code>465 00:28:22,940 --&gt; 00:28:24,940</code>
Let me turn that question around then.</p>
<p><code>466 00:28:24,940 --&gt; 00:28:28,940</code>
What would your recommendation be to someone getting into driver development then?</p>
<p><code>467 00:28:28,940 --&gt; 00:28:30,940</code>
Because it&rsquo;s hard to do it right.</p>
<p><code>468 00:28:30,940 --&gt; 00:28:32,940</code>
That&rsquo;s a great question.</p>
<p><code>469 00:28:32,940 --&gt; 00:28:36,940</code>
You need to understand the nuances of data management.</p>
<p><code>470 00:28:36,940 --&gt; 00:28:38,940</code>
How to treat user parameters.</p>
<p><code>471 00:28:38,940 --&gt; 00:28:43,940</code>
And always, always assume that the user is malicious.</p>
<p><code>472 00:28:43,940 --&gt; 00:28:47,940</code>
The first step that we needed to do in order to talk to a driver</p>
<p><code>473 00:28:47,940 --&gt; 00:28:50,940</code>
is to open a handle of it.</p>
<p><code>474 00:28:50,940 --&gt; 00:28:55,940</code>
If your driver does not need to talk with regular or limited users,</p>
<p><code>475 00:28:55,940 --&gt; 00:28:56,940</code>
don&rsquo;t allow it.</p>
<p><code>476 00:28:56,940 --&gt; 00:28:57,940</code>
No.</p>
<p><code>477 00:28:57,940 --&gt; 00:29:03,940</code>
Eliminate completely the entire risk of low or limited users.</p>
<p><code>478 00:29:03,940 --&gt; 00:29:05,940</code>
Because as Microsoft said,</p>
<p><code>479 00:29:05,940 --&gt; 00:29:08,940</code>
if you&rsquo;re an admin you can do whatever you want on your machine</p>
<p><code>480 00:29:08,940 --&gt; 00:29:12,940</code>
and it&rsquo;s not a really terrible thing that you have a bug in the driver.</p>
<p><code>481 00:29:12,940 --&gt; 00:29:14,940</code>
So that&rsquo;s the first step.</p>
<p><code>482 00:29:14,940 --&gt; 00:29:17,940</code>
And of course the more you can automate the testing,</p>
<p><code>483 00:29:17,940 --&gt; 00:29:19,940</code>
the better because you don&rsquo;t rely on the human eye then.</p>
<p><code>484 00:29:19,940 --&gt; 00:29:20,940</code>
Exactly.</p>
<p><code>485 00:29:20,940 --&gt; 00:29:23,940</code>
And that&rsquo;s a really good takeaway from your talk.</p>
<p><code>486 00:29:23,940 --&gt; 00:29:26,940</code>
So a lot of vulnerabilities you look at,</p>
<p><code>487 00:29:26,940 --&gt; 00:29:30,940</code>
you&rsquo;re basically looking at user communication to the driver.</p>
<p><code>488 00:29:30,940 --&gt; 00:29:36,940</code>
So you don&rsquo;t really need some hardware device doing something strange.</p>
<p><code>489 00:29:36,940 --&gt; 00:29:40,940</code>
But you&rsquo;re talking more to the user side of communication.</p>
<p><code>490 00:29:40,940 --&gt; 00:29:43,940</code>
That&rsquo;s almost entirely correct.</p>
<p><code>491 00:29:43,940 --&gt; 00:29:48,940</code>
Except in places that the drivers actually require a hardware counterpart.</p>
<p><code>492 00:29:48,940 --&gt; 00:29:51,940</code>
In this case you need either to emulate it</p>
<p><code>493 00:29:51,940 --&gt; 00:29:54,940</code>
or to use a PC to a PC</p>
<p><code>494 00:29:54,940 --&gt; 00:29:56,940</code>
or a laptop to a laptop.</p>
<p><code>495 00:29:56,940 --&gt; 00:29:59,940</code>
That means of communications because you actually need the device.</p>
<p><code>496 00:29:59,940 --&gt; 00:30:03,940</code>
In the worst case you can patch some of the driver code</p>
<p><code>497 00:30:03,940 --&gt; 00:30:07,940</code>
but it&rsquo;s a lot more difficult and it&rsquo;s more time consuming.</p>
<p><code>498 00:30:07,940 --&gt; 00:30:11,940</code>
But it&rsquo;s a great question and actually it&rsquo;s part of the things that we thought of</p>
<p><code>499 00:30:11,940 --&gt; 00:30:14,940</code>
that perhaps we might take on in the next research.</p>
<p><code>500 00:30:14,940 --&gt; 00:30:18,940</code>
Perhaps maybe find a way to also in some way automate</p>
<p><code>501 00:30:18,940 --&gt; 00:30:22,940</code>
although it would be very difficult these stubs and patches to the driver.</p>
<p><code>502 00:30:22,940 --&gt; 00:30:24,940</code>
Yeah, I can imagine.</p>
<p><code>503 00:30:24,940 --&gt; 00:30:25,940</code>
Yeah, you&rsquo;re saying good luck.</p>
<p><code>504 00:30:26,940 --&gt; 00:30:29,940</code>
Good luck, have fun.</p>
<p><code>505 00:30:29,940 --&gt; 00:30:30,940</code>
Sweet.</p>
<p><code>506 00:30:30,940 --&gt; 00:30:34,940</code>
But you mentioned, I think you quickly mentioned</p>
<p><code>507 00:30:34,940 --&gt; 00:30:36,940</code>
some horror stories.</p>
<p><code>508 00:30:36,940 --&gt; 00:30:38,940</code>
Did I understand correctly that there was one driver</p>
<p><code>509 00:30:38,940 --&gt; 00:30:41,940</code>
we had read write against any memory?</p>
<p><code>510 00:30:41,940 --&gt; 00:30:43,940</code>
Yeah, but that&rsquo;s a signed driver</p>
<p><code>511 00:30:43,940 --&gt; 00:30:48,940</code>
and actually I hope that most EDRs and AVs understand when we see this driver.</p>
<p><code>512 00:30:48,940 --&gt; 00:30:51,940</code>
Well, it&rsquo;s a signed driver made by some company</p>
<p><code>513 00:30:51,940 --&gt; 00:30:55,940</code>
that allows you to read and write memory directly into the kernel.</p>
<p><code>514 00:30:55,940 --&gt; 00:30:56,940</code>
And it&rsquo;s signed.</p>
<p><code>515 00:30:56,940 --&gt; 00:31:00,940</code>
So if you are an adversary and you have an admin access to the machine</p>
<p><code>516 00:31:00,940 --&gt; 00:31:03,940</code>
which is the required thing to load the driver</p>
<p><code>517 00:31:03,940 --&gt; 00:31:05,940</code>
even if it&rsquo;s a signed driver</p>
<p><code>518 00:31:05,940 --&gt; 00:31:08,940</code>
then you can use it and you have kernel mode control</p>
<p><code>519 00:31:08,940 --&gt; 00:31:11,940</code>
and you can do whatever you want on the machine.</p>
<p><code>520 00:31:11,940 --&gt; 00:31:17,940</code>
So one final question before we let you go and enjoy the rest of the conference here.</p>
<p><code>521 00:31:17,940 --&gt; 00:31:24,940</code>
What have the responses been when you&rsquo;ve reported the bugs to the vendors?</p>
<p><code>522 00:31:25,940 --&gt; 00:31:27,940</code>
Well, that&rsquo;s funny.</p>
<p><code>523 00:31:27,940 --&gt; 00:31:32,940</code>
Every vendor has its own idea and concept how to treat those bugs.</p>
<p><code>524 00:31:32,940 --&gt; 00:31:35,940</code>
For instance, some vendors took it very seriously</p>
<p><code>525 00:31:35,940 --&gt; 00:31:38,940</code>
and tried to patch it as quick as possible</p>
<p><code>526 00:31:38,940 --&gt; 00:31:41,940</code>
but as we said, the development cycles are very long</p>
<p><code>527 00:31:41,940 --&gt; 00:31:44,940</code>
and sometimes it&rsquo;s hard to compile the code again</p>
<p><code>528 00:31:44,940 --&gt; 00:31:46,940</code>
so it takes time.</p>
<p><code>529 00:31:46,940 --&gt; 00:31:50,940</code>
In some cases, they want us to test the patches out</p>
<p><code>530 00:31:50,940 --&gt; 00:31:53,940</code>
which also took some time</p>
<p><code>531 00:31:53,940 --&gt; 00:31:56,940</code>
and sometimes they just fixed it</p>
<p><code>532 00:31:56,940 --&gt; 00:31:59,940</code>
and on one occasion they said, we don&rsquo;t care.</p>
<p><code>533 00:31:59,940 --&gt; 00:32:07,940</code>
Do you have any names of companies</p>
<p><code>534 00:32:07,940 --&gt; 00:32:12,940</code>
or at least what kind of different peripherals the drivers are intended for?</p>
<p><code>535 00:32:12,940 --&gt; 00:32:18,940</code>
Mostly if you speak about hardware-related drivers</p>
<p><code>536 00:32:18,940 --&gt; 00:32:20,940</code>
so PCI-cards mostly</p>
<p><code>537 00:32:20,940 --&gt; 00:32:22,940</code>
so every vendor that is involved in that area</p>
<p><code>538 00:32:22,940 --&gt; 00:32:25,940</code>
probably has a vulnerable driver</p>
<p><code>539 00:32:25,940 --&gt; 00:32:27,940</code>
Windows drivers, of course</p>
<p><code>540 00:32:27,940 --&gt; 00:32:29,940</code>
processor drivers</p>
<p><code>541 00:32:29,940 --&gt; 00:32:31,940</code>
let it be Intel or AMD</p>
<p><code>542 00:32:31,940 --&gt; 00:32:34,940</code>
or GPUs ones like Nvidia as well</p>
<p><code>543 00:32:34,940 --&gt; 00:32:36,940</code>
Yeah, where are the good places to look for bugs?</p>
<p><code>544 00:32:36,940 --&gt; 00:32:37,940</code>
Cool.</p>
<p><code>545 00:32:37,940 --&gt; 00:32:42,940</code>
So, now I enable stupid mode here.</p>
<p><code>546 00:32:42,940 --&gt; 00:32:45,940</code>
So we got PCI-drivers</p>
<p><code>547 00:32:45,940 --&gt; 00:32:47,940</code>
and you mentioned processor drivers as well.</p>
<p><code>548 00:32:47,940 --&gt; 00:32:50,940</code>
But processor drivers, what do they do?</p>
<p><code>549 00:32:50,940 --&gt; 00:32:52,940</code>
Do they install them?</p>
<p><code>550 00:32:52,940 --&gt; 00:32:55,940</code>
Do they install some microcode into the processor?</p>
<p><code>551 00:32:55,940 --&gt; 00:32:59,940</code>
What are the processor drivers doing?</p>
<p><code>552 00:32:59,940 --&gt; 00:33:02,940</code>
Mostly things that are concerning the processor.</p>
<p><code>553 00:33:02,940 --&gt; 00:33:04,940</code>
They are not just&hellip;</p>
<p><code>554 00:33:04,940 --&gt; 00:33:06,940</code>
Sometimes they actually&hellip;</p>
<p><code>555 00:33:06,940 --&gt; 00:33:08,940</code>
Vendors, I don&rsquo;t want to blame any vendors</p>
<p><code>556 00:33:08,940 --&gt; 00:33:13,940</code>
they use drivers to channel data outside.</p>
<p><code>557 00:33:13,940 --&gt; 00:33:15,940</code>
So like&hellip;</p>
<p><code>558 00:33:15,940 --&gt; 00:33:17,940</code>
How do you call it?</p>
<p><code>559 00:33:17,940 --&gt; 00:33:20,940</code>
The reason I put it in Windows, I just forgot.</p>
<p><code>560 00:33:20,940 --&gt; 00:33:22,940</code>
To send just data home to collect it</p>
<p><code>561 00:33:22,940 --&gt; 00:33:24,940</code>
because now data is king</p>
<p><code>562 00:33:24,940 --&gt; 00:33:26,940</code>
and everyone is collecting huge abundance of data</p>
<p><code>563 00:33:26,940 --&gt; 00:33:31,940</code>
and also for monitoring, statistics and so on.</p>
<p><code>564 00:33:31,940 --&gt; 00:33:34,940</code>
Also there are usually multiple stacks of the drivers.</p>
<p><code>565 00:33:34,940 --&gt; 00:33:36,940</code>
Yeah, yeah, yeah.</p>
<p><code>566 00:33:36,940 --&gt; 00:33:39,940</code>
So not all of those would be obvious</p>
<p><code>567 00:33:39,940 --&gt; 00:33:43,940</code>
when normal people think about drivers.</p>
<p><code>568 00:33:43,940 --&gt; 00:33:46,940</code>
Is there any other sort of driver you have looked at?</p>
<p><code>569 00:33:46,940 --&gt; 00:33:48,940</code>
Like&hellip;</p>
<p><code>570 00:33:48,940 --&gt; 00:33:52,940</code>
Normal people who haven&rsquo;t looked into Windows drivers</p>
<p><code>571 00:33:52,940 --&gt; 00:33:55,940</code>
things I wouldn&rsquo;t expect to be drivers or something.</p>
<p><code>572 00:33:55,940 --&gt; 00:33:58,940</code>
Yeah, because if you want to hide your things</p>
<p><code>573 00:33:58,940 --&gt; 00:34:00,940</code>
put it in a driver</p>
<p><code>574 00:34:00,940 --&gt; 00:34:03,940</code>
and it automatically limits the amount of people that will look at it.</p>
<p><code>575 00:34:03,940 --&gt; 00:34:06,940</code>
There can be very simple things.</p>
<p><code>576 00:34:06,940 --&gt; 00:34:08,940</code>
Yeah, but you put it in a driver</p>
<p><code>577 00:34:08,940 --&gt; 00:34:10,940</code>
and people think, oh it&rsquo;s so complicated.</p>
<p><code>578 00:34:10,940 --&gt; 00:34:12,940</code>
But it&rsquo;s really not the case.</p>
<p><code>579 00:34:12,940 --&gt; 00:34:14,940</code>
There are complicated drivers</p>
<p><code>580 00:34:14,940 --&gt; 00:34:16,940</code>
but not all of them.</p>
<p><code>581 00:34:16,940 --&gt; 00:34:18,940</code>
Yeah, well there is a barrier.</p>
<p><code>582 00:34:18,940 --&gt; 00:34:20,940</code>
Like a barrier of entry.</p>
<p><code>583 00:34:20,940 --&gt; 00:34:22,940</code>
Things like what you have done is like</p>
<p><code>584 00:34:22,940 --&gt; 00:34:24,940</code>
trying to remove that barrier.</p>
<p><code>585 00:34:24,940 --&gt; 00:34:27,940</code>
Yeah, but we believe that now it&rsquo;s easier than before</p>
<p><code>586 00:34:27,940 --&gt; 00:34:33,940</code>
because there is great documentation nowadays.</p>
<p><code>587 00:34:33,940 --&gt; 00:34:36,940</code>
Not official ones because on Windows everything is closed source</p>
<p><code>588 00:34:36,940 --&gt; 00:34:39,940</code>
and you do not have symbols and so on.</p>
<p><code>589 00:34:39,940 --&gt; 00:34:41,940</code>
But it&rsquo;s a lot easier I think now</p>
<p><code>590 00:34:41,940 --&gt; 00:34:44,940</code>
than 10 years ago to find bugs in drivers.</p>
<p><code>591 00:34:44,940 --&gt; 00:34:48,940</code>
So finally, you mentioned that you were going to publish</p>
<p><code>592 00:34:48,940 --&gt; 00:34:49,940</code>
some of this&hellip;</p>
<p><code>593 00:34:49,940 --&gt; 00:34:54,940</code>
the work you&rsquo;ve done and code and so on.</p>
<p><code>594 00:34:54,940 --&gt; 00:34:57,940</code>
And we were to follow you on Twitter.</p>
<p><code>595 00:34:57,940 --&gt; 00:34:59,940</code>
So you need to tell us</p>
<p><code>596 00:34:59,940 --&gt; 00:35:03,940</code>
which Twitter handles should we make sure we follow?</p>
<p><code>597 00:35:03,940 --&gt; 00:35:04,940</code>
Oh, sure.</p>
<p><code>598 00:35:04,940 --&gt; 00:35:07,940</code>
So do you want me to spell it or try saying it?</p>
<p><code>599 00:35:08,940 --&gt; 00:35:10,940</code>
Is this mission impossible?</p>
<p><code>600 00:35:10,940 --&gt; 00:35:12,940</code>
For me it will be more difficult, I assume.</p>
<p><code>601 00:35:12,940 --&gt; 00:35:14,940</code>
Well, mine is</p>
<p><code>602 00:35:14,940 --&gt; 00:35:16,940</code>
Ocam Razor</p>
<p><code>603 00:35:16,940 --&gt; 00:35:18,940</code>
It&rsquo;s O-C-A-M</p>
<p><code>604 00:35:18,940 --&gt; 00:35:21,940</code>
R-A-Z-R</p>
<p><code>605 00:35:21,940 --&gt; 00:35:25,940</code>
Like the principle in machine learning of overfitting data.</p>
<p><code>606 00:35:25,940 --&gt; 00:35:27,940</code>
And mine is Eranchimony</p>
<p><code>607 00:35:27,940 --&gt; 00:35:29,940</code>
which is my name.</p>
<p><code>608 00:35:29,940 --&gt; 00:35:32,940</code>
E-R-A-N-S-H-I-M-O-N-Y</p>
<p><code>609 00:35:32,940 --&gt; 00:35:36,940</code>
But you also can find it in our presentation.</p>
<p><code>610 00:35:36,940 --&gt; 00:35:39,940</code>
So thank you very much for taking the time to talk to us</p>
<p><code>611 00:35:39,940 --&gt; 00:35:41,940</code>
and please enjoy the rest of your conference.</p>
<p><code>612 00:35:41,940 --&gt; 00:35:42,940</code>
Thank you very much.</p>
<p><code>613 00:35:42,940 --&gt; 00:35:43,940</code>
It was a blast.</p>
<p><code>614 00:35:43,940 --&gt; 00:35:47,940</code>
And I can just say I will definitely watch your talk afterwards</p>
<p><code>615 00:35:47,940 --&gt; 00:35:51,940</code>
because when I was looking through it</p>
<p><code>616 00:35:51,940 --&gt; 00:35:55,940</code>
your talk was one of those I really wanted to look at.</p>
<p><code>617 00:35:55,940 --&gt; 00:36:01,940</code>
Just out of curiosity, which part drove you most?</p>
<p><code>618 00:36:05,940 --&gt; 00:36:08,940</code>
How to fast drive is just general.</p>
<p><code>619 00:36:12,940 --&gt; 00:36:15,940</code>
So I worked a little bit with embedded developers</p>
<p><code>620 00:36:15,940 --&gt; 00:36:18,940</code>
and a little bit with driver developers</p>
<p><code>621 00:36:18,940 --&gt; 00:36:24,940</code>
and I mean it&rsquo;s complicated enough to debug normal software</p>
<p><code>622 00:36:24,940 --&gt; 00:36:26,940</code>
and fast normal software</p>
<p><code>623 00:36:26,940 --&gt; 00:36:30,940</code>
and typically the approach would be</p>
<p><code>624 00:36:30,940 --&gt; 00:36:33,940</code>
well, we&rsquo;ll build a test harness where we do the fussing</p>
<p><code>625 00:36:33,940 --&gt; 00:36:37,940</code>
and we fuss it in user land and we don&rsquo;t do the drivers</p>
<p><code>626 00:36:37,940 --&gt; 00:36:41,940</code>
and we just pick the C-code and build a test harness</p>
<p><code>627 00:36:41,940 --&gt; 00:36:44,940</code>
which can test it completely independently</p>
<p><code>628 00:36:44,940 --&gt; 00:36:46,940</code>
of the hardware stuff.</p>
<p><code>629 00:36:46,940 --&gt; 00:36:49,940</code>
But I think for a lot like</p>
<p><code>630 00:36:49,940 --&gt; 00:36:53,940</code>
when you move it into the driver stuff</p>
<p><code>631 00:36:53,940 --&gt; 00:36:58,940</code>
then from that point on it becomes</p>
<p><code>632 00:36:58,940 --&gt; 00:37:00,940</code>
like you have this problem</p>
<p><code>633 00:37:00,940 --&gt; 00:37:03,940</code>
but it becomes much harder for</p>
<p><code>634 00:37:03,940 --&gt; 00:37:08,940</code>
let&rsquo;s say normal people or people who haven&rsquo;t invested in how to do this</p>
<p><code>635 00:37:08,940 --&gt; 00:37:09,940</code>
that&rsquo;s much harder.</p>
<p><code>636 00:37:09,940 --&gt; 00:37:13,940</code>
So basically in my perspective the code base is typically well tuned.</p>
<p><code>637 00:37:13,940 --&gt; 00:37:16,940</code>
The code base is typically well tested</p>
<p><code>638 00:37:16,940 --&gt; 00:37:18,940</code>
until it&rsquo;s down in the driver</p>
<p><code>639 00:37:18,940 --&gt; 00:37:21,940</code>
but the things like the parses and things</p>
<p><code>640 00:37:21,940 --&gt; 00:37:24,940</code>
those you can easily extract and test when&hellip;</p>
<p><code>641 00:37:24,940 --&gt; 00:37:28,940</code>
I believe that the same errors that you have in user mode</p>
<p><code>642 00:37:28,940 --&gt; 00:37:31,940</code>
or like C-worn abilities are completely the same</p>
<p><code>643 00:37:31,940 --&gt; 00:37:33,940</code>
just the implications are different</p>
<p><code>644 00:37:33,940 --&gt; 00:37:36,940</code>
and also there are of course some</p>
<p><code>645 00:37:36,940 --&gt; 00:37:39,940</code>
specifics that change between Windows and Linux</p>
<p><code>646 00:37:39,940 --&gt; 00:37:42,940</code>
and Mac OS and so on</p>
<p><code>647 00:37:42,940 --&gt; 00:37:45,940</code>
but every C-bug just causes a crash in the kernel</p>
<p><code>648 00:37:45,940 --&gt; 00:37:47,940</code>
mostly crashes.</p>
<p><code>649 00:37:47,940 --&gt; 00:37:51,940</code>
I&rsquo;ve always been very impressed with</p>
<p><code>650 00:37:51,940 --&gt; 00:37:54,940</code>
people who do low level</p>
<p><code>651 00:37:54,940 --&gt; 00:37:57,940</code>
either reverse engineering or exploitation of things</p>
<p><code>652 00:37:57,940 --&gt; 00:38:01,940</code>
because I can say every single step</p>
<p><code>653 00:38:01,940 --&gt; 00:38:05,940</code>
is easy and trivial</p>
<p><code>654 00:38:05,940 --&gt; 00:38:08,940</code>
and I can imagine that</p>
<p><code>655 00:38:08,940 --&gt; 00:38:11,940</code>
I can do that, I can do that, that can be so hard</p>
<p><code>656 00:38:11,940 --&gt; 00:38:12,940</code>
but actually</p>
<p><code>657 00:38:12,940 --&gt; 00:38:14,940</code>
building the entire chain</p>
<p><code>658 00:38:14,940 --&gt; 00:38:16,940</code>
from building a test harness</p>
<p><code>659 00:38:16,940 --&gt; 00:38:17,940</code>
making a proof of concept</p>
<p><code>660 00:38:17,940 --&gt; 00:38:19,940</code>
and doing all those things</p>
<p><code>661 00:38:19,940 --&gt; 00:38:22,940</code>
and just keeping at it when</p>
<p><code>662 00:38:22,940 --&gt; 00:38:26,940</code>
the testing conditions isn&rsquo;t perfect</p>
<p><code>663 00:38:26,940 --&gt; 00:38:28,940</code>
it&rsquo;s much easier when you&rsquo;re like</p>
<p><code>664 00:38:28,940 --&gt; 00:38:31,940</code>
I just tested in user land</p>
<p><code>665 00:38:31,940 --&gt; 00:38:35,940</code>
and I&rsquo;m making the job easier</p>
<p><code>666 00:38:35,940 --&gt; 00:38:38,940</code>
but you&rsquo;re doing it black box</p>
<p><code>667 00:38:38,940 --&gt; 00:38:41,940</code>
and just moving past all</p>
<p><code>668 00:38:41,940 --&gt; 00:38:42,940</code>
the barriers</p>
<p><code>669 00:38:42,940 --&gt; 00:38:44,940</code>
that&rsquo;s one thing I think is very impressive</p>
<p><code>670 00:38:44,940 --&gt; 00:38:47,940</code>
and I&rsquo;m so impressed with people who</p>
<p><code>671 00:38:47,940 --&gt; 00:38:52,940</code>
like make exploits in weird environments</p>
<p><code>672 00:38:52,940 --&gt; 00:38:56,940</code>
or jump across all different hurdles</p>
<p><code>673 00:38:56,940 --&gt; 00:38:58,940</code>
when the exploitation things</p>
<p><code>674 00:38:58,940 --&gt; 00:39:02,940</code>
like doing everything like</p>
<p><code>675 00:39:02,940 --&gt; 00:39:04,940</code>
I can do that, I can do that, I can do that</p>
<p><code>676 00:39:04,940 --&gt; 00:39:06,940</code>
I can probably do all of that</p>
<p><code>677 00:39:06,940 --&gt; 00:39:09,940</code>
but actually doing the chain</p>
<p><code>678 00:39:09,940 --&gt; 00:39:10,940</code>
and making</p>
<p><code>679 00:39:10,940 --&gt; 00:39:12,940</code>
solving all the problems necessary</p>
<p><code>680 00:39:12,940 --&gt; 00:39:13,940</code>
to do that</p>
<p><code>681 00:39:13,940 --&gt; 00:39:15,940</code>
that&rsquo;s something I find</p>
<p><code>682 00:39:15,940 --&gt; 00:39:16,940</code>
extremely impressive</p>
<p><code>683 00:39:16,940 --&gt; 00:39:18,940</code>
and I can&rsquo;t</p>
<p><code>684 00:39:18,940 --&gt; 00:39:21,940</code>
too lazy personality to do that</p>
<p><code>685 00:39:21,940 --&gt; 00:39:24,940</code>
we are lazy too, trust us</p>
<p><code>686 00:39:24,940 --&gt; 00:39:27,940</code>
but you&rsquo;re lazy in a good way then</p>
<p><code>687 00:39:27,940 --&gt; 00:39:29,940</code>
so</p>
<p><code>688 00:39:29,940 --&gt; 00:39:30,940</code>
thank you again</p>
<p><code>689 00:39:30,940 --&gt; 00:39:32,940</code>
thank you very much</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-01-31</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/sec-t/">SEC-T</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/s_xe4_kerhetspodcasten_217_ostrukturerat_v_3/" class="prev" rel="prev" title="S&amp;#xe4;kerhetspodcasten #217 - Ostrukturerat V.3"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>S&#xe4;kerhetspodcasten #217 - Ostrukturerat V.3</a>
            <a href="/posts/s_xe4_kerhetspodcasten_218_sec_t_2021_del_2/" class="next" rel="next" title="S&amp;#xe4;kerhetspodcasten #218 - Sec-T 2021 Del 2">S&#xe4;kerhetspodcasten #218 - Sec-T 2021 Del 2<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
